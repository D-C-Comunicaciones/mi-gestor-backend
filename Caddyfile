api.dcmigestor.co, www.api.dcmigestor.co {
    redir https://api.dcmigestor.co{uri}
}

dcmigestor.co {
    encode zstd gzip

    header {
        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
        X-Frame-Options DENY
        X-Content-Type-Options nosniff
        Referrer-Policy strict-origin-when-cross-origin
    }

    handle {
        reverse_proxy api:3000 {
            health_uri /v1
            fail_duration 10s
            max_fails 3
        }
    }

    log {
        output stdout
        format console
    }
}